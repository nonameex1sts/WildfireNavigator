import json
from itertools import islice
from django.http import JsonResponse
from django.views.decorators.csrf import csrf_exempt
import math

# data is a list of clusters, each cluster is a dictionary with the following
# Latitude (float):         Latitude of the cluster center
# Longitude (float):        Longitude of the cluster center
# Damage (float):           Average damage level of the cluster

# Damage level (dict):      Dictionary of damage levels and their counts
# Street Type (dict):       Dictionary of street types and their counts
# Cities (dict):            Dictionary of cities and their counts
# CAL FIRE Unit (dict):     Dictionary of CAL FIRE units in charge and their counts
# Structure Type (dict):    Dictionary of structure types and their counts

# Radius (float):           Radius of the cluster
# Color (str):              Color of the cluster
data = [
    {"Latitude": 38.5947029342, "Longitude": -122.6630174125, "Damage": 2.5059149993,
     "Damage level": {"Destroyed (>50%)": 10991, "No Damage": 1867, "Affected (1-9%)": 533, "Minor (10-25%)": 200,
                      "Major (26-50%)": 102, "Inaccessible": 1},
     "Street Type": {"Road": 6435, "Drive": 2118, "Court": 1099, "Lane": 1057, "Way": 573, "Street": 567,
                     "Place": 489, "Circle": 338, "Avenue": 332, "Hwy": 224, "Trail": 190, "Other": 145,
                     "Boulevard": 50, "Parkway": 24, "Loop": 20, "Route": 12, "Terrace": 10, "Pass": 4, "Ext.": 3,
                     "not given": 2, "Dirt road": 1, "not noted": 1},
     "Cities": {"Unincorporated": 8208, "Santa Rosa": 3223, "Cobb": 504, "Lower Lake": 401, "Redwood City": 229,
                "Middletown": 217, "Napa": 215, "Healdsburg": 128, "Windsor": 110, "Sonoma": 52, "Winters": 50,
                "Ukiah": 42, "Clearlake ": 42, "Ukiah ": 41, "Clear Lake ": 38, "Spring Valley": 32,
                "Clearlake Oaks": 21, "Lakeport": 19, "Redwood Valley": 18, "Vacaville ": 9, "Clear Lake": 9,
                "Winters ": 9, "Loch Lomond ": 8, "Clearlake": 8, "Lake Pillsbury ": 7, "Lucerne": 6,
                "Potter Valley": 5, "Nappa": 4, "Whispering Pines": 4, "Petaluma": 4, "Lake Pillsbury": 4,
                "St. Helena": 4, "Rumsey": 3, "Anderson Springs ": 3, "Geyserville": 3, "Clear lake": 2,
                "Upper Lake": 2, "Napa ": 2, "The Geysers": 1, "Avalon Springs": 1, "Clover Dale": 1, "Willits": 1,
                "Kelseyville": 1, "Lakeport ": 1, "#31": 1, "Vacaville": 1},
     "CAL FIRE Unit": {"LNU": 13013, "MEU": 681},
     "Structure Type": {"Single Family Residence Single Story": 4554, "Single Family Residence Multi Story": 4044,
                        "Utility Misc Structure": 3618, "Mobile Home Double Wide": 431,
                        "Mobile Home Single Wide": 311, "Commercial Building Single Story": 208,
                        "Multi Family Residence Single Story": 124, "Multi Family Residence Multi Story": 109,
                        "School": 81, "Motor Home": 60, "Commercial Building Multi Story": 48,
                        "Mobile Home Triple Wide": 42, "Utility or Miscellaneous Structure > 120 sqft": 23,
                        "Infrastructure": 19, "Mixed Commercial\/Residential": 16, "Church": 3, "Hospital": 2,
                        "Agriculture": 1}, "Radius": 9.6140395815, "Color": "#7C0A02"},
    {"Latitude": 38.5536382619, "Longitude": -121.1425985678, "Damage": 1.8333333333,
     "Damage level": {"Major (26-50%)": 2, "No Damage": 2, "Affected (1-9%)": 1, "Minor (10-25%)": 1},
     "Street Type": {"Road": 6}, "Cities": {"Folsom": 5, "RAncho Cordova": 1}, "CAL FIRE Unit": {"AEU": 6},
     "Structure Type": {"Utility Misc Structure": 6}, "Radius": 0.4496485827, "Color": "#BF0A30"},
    {"Latitude": 39.7484373282, "Longitude": -121.5879977291, "Damage": 2.7483538904,
     "Damage level": {"Destroyed (>50%)": 19397, "No Damage": 1344, "Affected (1-9%)": 660, "Minor (10-25%)": 116,
                      "Major (26-50%)": 45, "Inaccessible": 4},
     "Street Type": {"Road": 8399, "Drive": 4448, "Lane": 3884, "Way": 1547, "Court": 1252, "Circle": 707,
                     "Avenue": 304, "Street": 266, "Place": 218, "Other": 159, "Boulevard": 143, "Trail": 90,
                     "Terrace": 81, "Loop": 25, "Parkway": 18, "Hwy": 18, "-": 7},
     "Cities": {"Magalia": 2633, "Paradise Northwest B": 1706, "Unincorporated": 1626,
                "Paradise Central Southwest B": 1550, "Paradise Central Southeast A": 1507,
                "Paradise Southwest B": 1373, "Paradise Southeast B": 1303, "Paradise Central Southeast B": 1207,
                "Paradise Central Southwest A": 1204, "Paradise Southeast A": 1103, "Paradise Northeast A": 964,
                "Paradise Northwest A": 934, "Paradise Northeast B": 912, "Cohasset": 772,
                "Concow\/Yankee Hill": 717, "Paradise Southwest A": 642, "Chico": 300, "Oroville": 273,
                "Forest Ranch": 208, "Grass Valley": 143, "Colfax": 106, "Grass Valley ": 88, "Feather Falls": 59,
                "Colfax ": 41, "Palermo": 34, "Paradise": 28, "Nevada City": 21, "Browns Valley": 20,
                "Oregon House": 19, "Brownsville ": 17, "Stirling City": 13, "Nevada city ": 13, "Bangor": 12,
                "North San Juan": 11, "Nevada city": 3, "Butte Meadows": 2, "Bangor ": 1, " ": 1},
     "CAL FIRE Unit": {"BTU": 20788, "NEU": 776, "TGU": 2},
     "Structure Type": {"Single Family Residence Single Story": 9227, "Utility Misc Structure": 5327,
                        "Mobile Home Double Wide": 2780, "Single Family Residence Multi Story": 2053,
                        "Mobile Home Single Wide": 942, "Commercial Building Single Story": 392,
                        "Mobile Home Triple Wide": 245, "Multi Family Residence Single Story": 226,
                        "Motor Home": 168, "Multi Family Residence Multi Story": 57,
                        "Commercial Building Multi Story": 55, "School": 44, "Infrastructure": 22, "Church": 19,
                        "Mixed Commercial\/Residential": 8, "Utility or Miscellaneous Structure > 120 sqft": 1},
     "Radius": 4.8126898816, "Color": "#7C0A02"},
    {"Latitude": 37.0197890805, "Longitude": -121.4769219856, "Damage": 3.0,
     "Damage level": {"Destroyed (>50%)": 4}, "Street Type": {"Road": 4}, "Cities": {"Gilroy": 4},
     "CAL FIRE Unit": {"SCU": 4},
     "Structure Type": {"Utility Misc Structure": 3, "Single Family Residence Multi Story": 1},
     "Radius": 0.6716965372, "Color": "#7C0A02"},
    {"Latitude": 36.6714292277, "Longitude": -120.9962695368, "Damage": 0.75,
     "Damage level": {"No Damage": 3, "Destroyed (>50%)": 1}, "Street Type": {"Road": 4},
     "Cities": {"Paicines ": 2, "Antelope ": 1, "Paicines": 1}, "CAL FIRE Unit": {"BEU": 4},
     "Structure Type": {"Single Family Residence Single Story": 2, "Single Family Residence Multi Story": 1,
                        "Utility Misc Structure": 1}, "Radius": 0.1236467068, "Color": "#FA8072"},
    {"Latitude": 40.1750755474, "Longitude": -120.9402883637, "Damage": 1.0483968542,
     "Damage level": {"No Damage": 2106, "Destroyed (>50%)": 1120, "Affected (1-9%)": 60, "Minor (10-25%)": 11,
                      "Inaccessible": 6, "Major (26-50%)": 3},
     "Street Type": {"Road": 1748, "Street": 495, "Other": 248, "Drive": 246, "Lane": 156, "Avenue": 99, "Loop": 74,
                     "Boulevard": 56, "Trail": 51, "Way": 51, "Route": 35, "Circle": 17, "Court": 14, "Alley": 11,
                     "Place": 5},
     "Cities": {"Greenville": 1501, "Chester": 480, "Taylorsville": 322, "Janesville": 261, "Twain": 153,
                "Susanville ": 113, "Milford": 80, "Quincy": 77, "Crescent Mills": 69, "Canyon Dam": 61,
                "Mill Creek": 52, "Belden": 48, "Storrie": 32, "Susanville": 24, "Mineral": 18,
                "Blairsden Graeagle": 9, "Warner Valley": 3, "Oroville": 2, "Keddie": 1},
     "CAL FIRE Unit": {"LMU": 3236, "TGU": 70},
     "Structure Type": {"Utility Misc Structure": 1155, "Single Family Residence Single Story": 1065,
                        "Single Family Residence Multi Story": 535, "Commercial Building Single Story": 178,
                        "Mobile Home Double Wide": 122, "Mobile Home Single Wide": 76, "Motor Home": 70,
                        "Multi Family Residence Single Story": 31, "Mobile Home Triple Wide": 22,
                        "Commercial Building Multi Story": 17, "School": 12, "Infrastructure": 7, "Church": 7,
                        "Mixed Commercial\/Residential": 5, "Multi Family Residence Multi Story": 4},
     "Radius": 8.0710410667, "Color": "#FF2400"},
    {"Latitude": 41.0888011771, "Longitude": -120.8279468318, "Damage": 1.5454545455,
     "Damage level": {"No Damage": 15, "Destroyed (>50%)": 13, "Minor (10-25%)": 4, "Major (26-50%)": 1},
     "Street Type": {"Road": 27, "Other": 3, "Trail": 2, "Way": 1},
     "Cities": {"Adin": 14, "McArthur": 6, "Bieber": 6, "Termo": 4, "Hayden Hill": 3}, "CAL FIRE Unit": {"LMU": 33},
     "Structure Type": {"Single Family Residence Single Story": 12, "Utility Misc Structure": 10,
                        "Mobile Home Single Wide": 4, "Motor Home": 3, "Single Family Residence Multi Story": 3,
                        "Mixed Commercial\/Residential": 1}, "Radius": 1.7446354127, "Color": "#FF2400"},
    {"Latitude": 35.3110999614, "Longitude": -120.0082655522, "Damage": 3.0,
     "Damage level": {"Destroyed (>50%)": 8}, "Street Type": {"Road": 4, "Trail": 3, "Way": 1},
     "Cities": {"Santa Margarita": 4, "Santa Margarita ": 4}, "CAL FIRE Unit": {"SLU": 8},
     "Structure Type": {"Utility Misc Structure": 4, "Single Family Residence Single Story": 2,
                        "Mobile Home Single Wide": 2}, "Radius": 0.2273744396, "Color": "#7C0A02"},
    {"Latitude": 33.8533003625, "Longitude": -116.9573401632, "Damage": 0.7001779359,
     "Damage level": {"No Damage": 837, "Destroyed (>50%)": 229, "Affected (1-9%)": 30, "Minor (10-25%)": 15,
                      "Major (26-50%)": 7, "Inaccessible": 6},
     "Street Type": {"Road": 553, "Lane": 249, "Drive": 125, "Street": 54, "Way": 51, "Avenue": 34, "Court": 32,
                     "Other": 14, "Trail": 11, "Circle": 1},
     "Cities": {"Hemet": 340, "Aguanga": 156, "Highland": 139, "Running Springs": 133, "Calimesa": 110,
                "Banning": 58, "Banning ": 28, "Big Bear Lake": 25, "Anza": 23, "Poppet Flats": 23, "Yucaipa": 11,
                "Yucaipa ": 11, "Cherryville ": 10, "Cherry Valley": 9, "Idyllwild": 9, "Oak Glen": 7,
                "Redlands": 6, "Beaumont ": 5, "Unincorporated": 5, "Cherry valley": 4, "banning": 3, " ": 2,
                "cherry valley ": 2, "Glen Oak": 1, "Colton": 1, "Bannig": 1, "banning ": 1, "Beaumont": 1},
     "CAL FIRE Unit": {"RRU": 798, "BDU": 326},
     "Structure Type": {"Single Family Residence Single Story": 283, "Utility Misc Structure": 272,
                        "Single Family Residence Multi Story": 270, "Mobile Home Double Wide": 139,
                        "Mobile Home Single Wide": 53, "Commercial Building Single Story": 40, "Motor Home": 21,
                        "Mixed Commercial\/Residential": 17, "Infrastructure": 16, "Mobile Home Triple Wide": 5,
                        "Commercial Building Multi Story": 5, "Multi Family Residence Single Story": 3},
     "Radius": 8.6029271897, "Color": "#FA8072"},
    {"Latitude": 35.4121738975, "Longitude": -120.4688027018, "Damage": 2.8333333333,
     "Damage level": {"Destroyed (>50%)": 11, "Affected (1-9%)": 1}, "Street Type": {"Road": 11, "Hwy": 1},
     "Cities": {"Creston": 5, "Santa Margarita ": 4, "SANTA MARGARITA": 3}, "CAL FIRE Unit": {"SLU": 12},
     "Structure Type": {"Utility Misc Structure": 5, "Single Family Residence Multi Story": 3,
                        "Mobile Home Double Wide": 2, "Single Family Residence Single Story": 1,
                        "Mobile Home Single Wide": 1}, "Radius": 0.8190806303, "Color": "#7C0A02"},
    {"Latitude": 38.7484326836, "Longitude": -120.2685005268, "Damage": 0.7438463619,
     "Damage level": {"No Damage": 2739, "Destroyed (>50%)": 871, "Affected (1-9%)": 57, "Minor (10-25%)": 18,
                      "Major (26-50%)": 10, "Inaccessible": 2},
     "Street Type": {"Road": 1711, "Drive": 984, "Way": 233, "Street": 217, "Lane": 201, "Court": 123, "Other": 66,
                     "Avenue": 57, "Trail": 43, "Circle": 39, "Place": 20, "Loop": 2, "Alley": 1},
     "Cities": {"South Lake Tahoe": 1278, "Grizzly Flats": 758, "Twin Bridges": 490, "Echo Lake": 295,
                "Somerset": 216, "Placerville": 197, "Grizzly Flats ": 192, "Pollock Pines": 138, "Pioneer": 50,
                "Kyburz": 35, "Placerville ": 13, " Grizzly Flats": 9, "Kirkwood": 5, "Eldorado ": 5, "Camino": 4,
                "Fiddletown": 3, "Cameron Park ": 2, "Rescue": 2, "Grizzly Flat": 1, " Grizzly Flats ": 1,
                "Eldorado Hills ": 1, "Cameron Park": 1, "Shingle Springs": 1}, "CAL FIRE Unit": {"AEU": 3697},
     "Structure Type": {"Single Family Residence Multi Story": 1556, "Single Family Residence Single Story": 1049,
                        "Utility Misc Structure": 786, "Commercial Building Single Story": 130,
                        "Mobile Home Double Wide": 58, "Motor Home": 27, "Infrastructure": 22,
                        "Mobile Home Single Wide": 21, "Commercial Building Multi Story": 18,
                        "Multi Family Residence Multi Story": 9, "Multi Family Residence Single Story": 9,
                        "Mobile Home Triple Wide": 6, "Mixed Commercial\/Residential": 4, "School": 1, "Church": 1},
     "Radius": 8.0802741806, "Color": "#FA8072"},
    {"Latitude": 35.6367618414, "Longitude": -118.4950419468, "Damage": 1.2581743869,
     "Damage level": {"No Damage": 828, "Destroyed (>50%)": 587, "Affected (1-9%)": 34, "Minor (10-25%)": 10,
                      "Major (26-50%)": 7, "Inaccessible": 2},
     "Street Type": {"Road": 738, "Drive": 251, "Street": 131, "Court": 123, "Avenue": 85, "Way": 46, "Lane": 28,
                     "Loop": 26, "Place": 21, "Trail": 16, "Boulevard": 3},
     "Cities": {"Wofford Heights": 345, "Caliente": 274, "SOUTH LAKE": 265, "Havilah": 195, "Johnsondale ": 102,
                "Posey": 63, "Caliente ": 29, "Posey ": 28, "WELDON": 24, "LAKE ISABELLA": 22, "Lake Isabella": 20,
                "California Hot Springs": 19, "Wofford Heights ": 18, "Bodfish": 12, "SQUIRREL MTN VA": 11,
                "MT MESA": 6, "CALIENTE ": 5, " Caliente ": 4, "Unincorporated": 4, "Lake Isabella ": 4,
                "Caliente-Bodfish": 3, "MTN MESA": 2, "SQUIRREL VLY": 2, "Ca": 2, "Johnsondale": 2,
                "Johnson Dale": 2, "MOUNTAIN MESA": 1, "Havilah ": 1, "Kernville": 1, "Cal": 1, " CALIENTE ": 1},
     "CAL FIRE Unit": {"KRN": 1252, "TUU": 216},
     "Structure Type": {"Utility Misc Structure": 411, "Single Family Residence Single Story": 399,
                        "Mobile Home Double Wide": 241, "Single Family Residence Multi Story": 189,
                        "Mobile Home Single Wide": 135, "Motor Home": 46, "Mobile Home Triple Wide": 18,
                        "Commercial Building Single Story": 14, "Infrastructure": 8,
                        "Multi Family Residence Single Story": 2, "Commercial Building Multi Story": 2,
                        "Multi Family Residence Multi Story": 1, "Mixed Commercial\/Residential": 1, "School": 1},
     "Radius": 5.1035868683, "Color": "#FF2400"},
    {"Latitude": 40.6068841055, "Longitude": -122.4477111856, "Damage": 2.0697511392,
     "Damage level": {"Destroyed (>50%)": 1853, "No Damage": 778, "Affected (1-9%)": 158, "Minor (10-25%)": 30,
                      "Major (26-50%)": 30, "Inaccessible": 4},
     "Street Type": {"Road": 1131, "Drive": 596, "Lane": 384, "Street": 190, "Way": 170, "Trail": 142, "Other": 65,
                     "Court": 37, "Circle": 33, "Terrace": 30, "Avenue": 22, "Alley": 19, "Place": 14,
                     "Parkway": 11, "Route": 8, " ": 1},
     "Cities": {"Unincorporated": 1423, "Redding": 763, "Anderson": 325, "Platina": 81, "Lakehead": 81,
                "Cottonwood": 34, "Red Bluff ": 27, "Red Bluff": 25, "Shasta Lake": 24, "Shasta": 18,
                "Bella Vista": 12, "Anderson ": 8, "Cottonwood ": 5, "Lakehead ": 5, "Unknown": 5, "Redding ": 3,
                "Platina ": 3, "Tahama": 3, " ": 3, "French Gulch": 2, "Oak Run": 1, "Millville ": 1, "Ono": 1},
     "CAL FIRE Unit": {"SHU": 2677, "TGU": 176},
     "Structure Type": {"Utility Misc Structure": 1139, "Single Family Residence Single Story": 928,
                        "Single Family Residence Multi Story": 273, "Mobile Home Double Wide": 201,
                        "Mobile Home Single Wide": 157, "Motor Home": 89, "Commercial Building Single Story": 25,
                        "Infrastructure": 19, "Mobile Home Triple Wide": 14, "Commercial Building Multi Story": 2,
                        "Utility or Miscellaneous Structure > 120 sqft": 2,
                        "Multi Family Residence Single Story": 2, "Mixed Commercial\/Residential": 1,
                        "Multi Family Residence Multi Story": 1}, "Radius": 5.7296582756, "Color": "#BF0A30"},
    {"Latitude": 39.6134408371, "Longitude": -122.5884274287, "Damage": 0.2692307692,
     "Damage level": {"No Damage": 47, "Destroyed (>50%)": 4, "Minor (10-25%)": 1},
     "Street Type": {"Road": 49, "Route": 3},
     "Cities": {"Elk Creek ": 16, "Elk Creek": 15, "Elk Grove": 12, "Orland": 9}, "CAL FIRE Unit": {"TGU": 52},
     "Structure Type": {"Utility Misc Structure": 27, "Single Family Residence Single Story": 18,
                        "Mobile Home Single Wide": 4, "Single Family Residence Multi Story": 1,
                        "Mobile Home Double Wide": 1, "Commercial Building Single Story": 1},
     "Radius": 1.4581562588, "Color": "#FA8072"},
    {"Latitude": 34.6972378854, "Longitude": -118.4949018465, "Damage": 2.9166666667,
     "Damage level": {"Destroyed (>50%)": 30, "Minor (10-25%)": 3, "Major (26-50%)": 2, "Affected (1-9%)": 1},
     "Street Type": {"Road": 36},
     "Cities": {"LAKE HUGHES ": 17, "LAKE HUGHES": 14, "LANCASTER ": 4, "LANCASTER": 1},
     "CAL FIRE Unit": {"LAC": 36},
     "Structure Type": {"Utility Misc Structure": 24, "Single Family Residence Single Story": 11,
                        "Mobile Home Double Wide": 1}, "Radius": 0.4281529497, "Color": "#7C0A02"},
    {"Latitude": 39.488377008, "Longitude": -123.3804918454, "Damage": 1.640776699,
     "Damage level": {"Destroyed (>50%)": 56, "No Damage": 46, "Affected (1-9%)": 1},
     "Street Type": {"Road": 67, "Other": 32, "Drive": 4}, "Cities": {"Willits": 61, "Willits ": 42},
     "CAL FIRE Unit": {"MEU": 103},
     "Structure Type": {"Utility Misc Structure": 44, "Single Family Residence Single Story": 24, "Motor Home": 16,
                        "Single Family Residence Multi Story": 15, "Mobile Home Single Wide": 4},
     "Radius": 0.3888966349, "Color": "#BF0A30"},
    {"Latitude": 40.0966427494, "Longitude": -123.4168503273, "Damage": 1.3939393939,
     "Damage level": {"No Damage": 68, "Destroyed (>50%)": 57, "Affected (1-9%)": 3, "Minor (10-25%)": 2,
                      "Major (26-50%)": 1, "Inaccessible": 1}, "Street Type": {"Road": 122, "Drive": 6, "Other": 4},
     "Cities": {"Zenia": 43, "Kettenpom": 40, "Kettenpom ": 36, "Nielson Place": 4, "Zenia ": 3, "Kettempon": 1,
                "Kettlepom": 1, "Kettenpon": 1, "kettenpom ": 1, "unknown": 1, "Ramsey": 1},
     "CAL FIRE Unit": {"HUU": 123, "MEU": 9},
     "Structure Type": {"Utility Misc Structure": 79, "Single Family Residence Single Story": 28,
                        "Single Family Residence Multi Story": 14, "Motor Home": 3, "Mobile Home Single Wide": 2,
                        "Infrastructure": 2, "Mobile Home Double Wide": 2, "Multi Family Residence Single Story": 1,
                        "Multi Family Residence Multi Story": 1}, "Radius": 2.108782278, "Color": "#FF2400"},
    {"Latitude": 39.8150615207, "Longitude": -123.0247348653, "Damage": 0.4732142857,
     "Damage level": {"No Damage": 94, "Destroyed (>50%)": 16, "Affected (1-9%)": 1, "Major (26-50%)": 1},
     "Street Type": {"Road": 108, "Lane": 3, "Other": 1},
     "Cities": {"Covelo ": 58, "Covelo": 51, "Cobalt": 1, "Coveli": 1, "Unknown": 1}, "CAL FIRE Unit": {"MEU": 112},
     "Structure Type": {"Utility Misc Structure": 42, "Single Family Residence Single Story": 34,
                        "Single Family Residence Multi Story": 25, "Motor Home": 8, "Mobile Home Single Wide": 3},
     "Radius": 1.0390288545, "Color": "#FA8072"},
    {"Latitude": 39.6063165671, "Longitude": -123.1403103866, "Damage": 0.0, "Damage level": {"No Damage": 7},
     "Street Type": {"Road": 7}, "Cities": {"Covelo": 7}, "CAL FIRE Unit": {"MEU": 7},
     "Structure Type": {"Motor Home": 3, "Utility Misc Structure": 2, "Single Family Residence Single Story": 1,
                        "Commercial Building Multi Story": 1}, "Radius": 1.0553569895, "Color": "#FA8072"},
    {"Latitude": 40.037903685, "Longitude": -123.6844016319, "Damage": 3.0, "Damage level": {"Destroyed (>50%)": 6},
     "Street Type": {"Road": 6}, "Cities": {"Garberville": 6}, "CAL FIRE Unit": {"HUU": 6},
     "Structure Type": {"Utility Misc Structure": 4, "Single Family Residence Single Story": 2},
     "Radius": 1.2457083358, "Color": "#7C0A02"},
    {"Latitude": 36.4386868361, "Longitude": -121.744284742, "Damage": 1.9289617486,
     "Damage level": {"Destroyed (>50%)": 110, "No Damage": 63, "Minor (10-25%)": 4, "Major (26-50%)": 3,
                      "Affected (1-9%)": 3},
     "Street Type": {"Road": 164, "Lane": 11, "Other": 6, "Drive": 1, "Trail": 1},
     "Cities": {"Unincorporated": 73, "Carmel Valley": 43, "Salinas ": 26, "Salinas": 13, "Carmel": 8,
                "Monterey": 7, " ": 6, "Carmel Valley ": 5, "Monterey ": 1, "Camel Valley": 1},
     "CAL FIRE Unit": {"BEU": 183},
     "Structure Type": {"Single Family Residence Single Story": 92, "Single Family Residence Multi Story": 43,
                        "Utility Misc Structure": 41, "Motor Home": 3, "Mobile Home Single Wide": 2,
                        "Commercial Building Single Story": 1, "Infrastructure": 1}, "Radius": 3.9461363644,
     "Color": "#BF0A30"}, {"Latitude": 37.4097986745, "Longitude": -121.5602190235, "Damage": 1.0358974359,
                           "Damage level": {"No Damage": 123, "Destroyed (>50%)": 60, "Affected (1-9%)": 6,
                                            "Major (26-50%)": 2, "Inaccessible": 2, "Minor (10-25%)": 2},
                           "Street Type": {"Road": 144, "Route": 49, "Other": 1, "Lane": 1},
                           "Cities": {"na": 51, "San Jose ": 34, "Na": 30, "Livermore ": 22, "San Jose": 14,
                                      "N\/a": 11, "Tracy": 9, "Livermore": 7, "Patterson": 4, "nA": 2, "A": 2,
                                      "Tracy ": 1, "B": 1, "N\/\/A": 1, "tracy": 1, " N\/A": 1, "county": 1,
                                      "An": 1, " na": 1, "Patterson ": 1}, "CAL FIRE Unit": {"SCU": 195},
                           "Structure Type": {"Single Family Residence Single Story": 71,
                                              "Utility Misc Structure": 50,
                                              "Single Family Residence Multi Story": 31,
                                              "Mobile Home Single Wide": 15, "Motor Home": 8,
                                              "Multi Family Residence Multi Story": 5, "Infrastructure": 5,
                                              "Mobile Home Double Wide": 5, "Commercial Building Single Story": 2,
                                              "Commercial Building Multi Story": 2,
                                              "Mixed Commercial\/Residential": 1}, "Radius": 3.373128926,
                           "Color": "#FF2400"},
    {"Latitude": 40.0061724585, "Longitude": -120.1425848673, "Damage": 1.093418259,
     "Damage level": {"No Damage": 290, "Destroyed (>50%)": 153, "Affected (1-9%)": 10, "Minor (10-25%)": 8,
                      "Major (26-50%)": 5, "Inaccessible": 5},
     "Street Type": {"Road": 260, "Drive": 133, "Lane": 24, "Loop": 19, "Street": 18, "Trail": 8, "Other": 7,
                     "Court": 2},
     "Cities": {"Doyle": 341, "Doyle ": 54, "Portola ": 47, "Chilcoot": 11, "Quincy": 7, "Portola": 5, "Vinton": 3,
                "Beckwourth": 2, "Herlong": 1}, "CAL FIRE Unit": {"LMU": 471},
     "Structure Type": {"Utility Misc Structure": 203, "Single Family Residence Single Story": 120,
                        "Single Family Residence Multi Story": 39, "Mobile Home Single Wide": 33, "Motor Home": 33,
                        "Mobile Home Double Wide": 28, "Commercial Building Single Story": 7,
                        "Mobile Home Triple Wide": 4, "Commercial Building Multi Story": 2, "Church": 1,
                        "Infrastructure": 1}, "Radius": 2.6255912233, "Color": "#FF2400"},
    {"Latitude": 34.2107334928, "Longitude": -118.9351578574, "Damage": 1.7861847962,
     "Damage level": {"Destroyed (>50%)": 2836, "No Damage": 1853, "Affected (1-9%)": 575, "Minor (10-25%)": 207,
                      "Major (26-50%)": 122, "Inaccessible": 24},
     "Street Type": {"Road": 2289, "Drive": 1628, "Avenue": 365, "Lane": 274, "Street": 249, "Court": 227,
                     "Way": 162, "Other": 154, "Place": 93, "Circle": 80, "Terrace": 43, "Trail": 27, "Hwy": 15,
                     "Boulevard": 11},
     "Cities": {"Malibu": 1268, "Camarillo": 1054, "Unincorporated": 1033, "Los Angeles County": 701,
                "Ventura": 541, "Somis": 471, "Los Angeles": 220, "Santa Paula": 127, "Santa Clarita": 39,
                "Agoura Hills": 37, "Moorpark": 37, "Thousand Oaks": 33, "Calabasas": 23, "Westlake Village": 21,
                "Fillmore": 11, "Hidden Hills": 1}, "CAL FIRE Unit": {"VNC": 3092, "LAC": 2435, "SBC": 90},
     "Structure Type": {"Single Family Residence Single Story": 1984, "Single Family Residence Multi Story": 1531,
                        "Utility Misc Structure": 1371, "Commercial Building Single Story": 186,
                        "Mobile Home Double Wide": 156, "Multi Family Residence Multi Story": 106,
                        "Mobile Home Single Wide": 101, "Motor Home": 47, "Infrastructure": 43,
                        "Commercial Building Multi Story": 27, "School": 24,
                        "Multi Family Residence Single Story": 17, "Mobile Home Triple Wide": 10, "Church": 7,
                        "Mixed Commercial\/Residential": 7}, "Radius": 8.2348234263, "Color": "#BF0A30"},
    {"Latitude": 40.1803480066, "Longitude": -122.2707740899, "Damage": 2.6315789474,
     "Damage level": {"Destroyed (>50%)": 15, "No Damage": 2, "Affected (1-9%)": 1, "Major (26-50%)": 1},
     "Street Type": {"Street": 6, "Road": 6, "Drive": 4, "Lane": 3},
     "Cities": {"Unincorporated": 15, "Red Bluff": 4}, "CAL FIRE Unit": {"TGU": 19},
     "Structure Type": {"Commercial Building Single Story": 6, "Utility Misc Structure": 3, "Agriculture": 2,
                        "Mobile Home Double Wide": 2, "Commercial Building Multi Story": 2,
                        "Single Family Residence Single Story": 2, "Mobile Home Single Wide": 1,
                        "Single Family Residence Multi Story": 1}, "Radius": 0.5821632585, "Color": "#7C0A02"},
    {"Latitude": 41.8567321904, "Longitude": -122.7533786022, "Damage": 2.0061349693,
     "Damage level": {"Destroyed (>50%)": 205, "No Damage": 99, "Affected (1-9%)": 13, "Minor (10-25%)": 5,
                      "Major (26-50%)": 4},
     "Street Type": {"Road": 217, "Other": 63, "Street": 32, "Lane": 5, "Drive": 5, "Way": 4},
     "Cities": {"Klamath River": 155, "Unincorporated": 95, "Horse Creek": 26, "Yreka": 25, "Scott Bar": 15,
                "Montague": 6, "Mount Shasta": 2, " ": 2}, "CAL FIRE Unit": {"SKU": 326},
     "Structure Type": {"Utility Misc Structure": 139, "Single Family Residence Single Story": 84,
                        "Single Family Residence Multi Story": 33, "Mobile Home Single Wide": 25,
                        "Mobile Home Double Wide": 23, "Commercial Building Single Story": 10, "Motor Home": 7,
                        "Infrastructure": 2, "Multi Family Residence Single Story": 1, "Mobile Home Triple Wide": 1,
                        "Mixed Commercial\/Residential": 1}, "Radius": 4.7578155016, "Color": "#BF0A30"},
    {"Latitude": 33.6588055628, "Longitude": -117.4326515178, "Damage": 2.1635220126,
     "Damage level": {"Destroyed (>50%)": 106, "No Damage": 32, "Affected (1-9%)": 16, "Minor (10-25%)": 5},
     "Street Type": {"Road": 137, "Trail": 8, "Other": 6, "Drive": 5, "Place": 2, "Court": 1},
     "Cities": {"Lake Elsinore": 61, "San Juan Capistrano": 60, "Unincorporated": 37, "Corona": 1},
     "CAL FIRE Unit": {"RRU": 86, "ORC": 73},
     "Structure Type": {"Single Family Residence Single Story": 91, "Utility Misc Structure": 24,
                        "Single Family Residence Multi Story": 19, "Motor Home": 7, "Mobile Home Double Wide": 6,
                        "Commercial Building Single Story": 4, "Mobile Home Single Wide": 3,
                        "Commercial Building Multi Story": 3, "Infrastructure": 2}, "Radius": 1.0832714618,
     "Color": "#BF0A30"}, {"Latitude": 37.2039087733, "Longitude": -119.4885037145, "Damage": 1.1393442623,
                           "Damage level": {"No Damage": 72, "Destroyed (>50%)": 43, "Affected (1-9%)": 4,
                                            "Minor (10-25%)": 3},
                           "Street Type": {"Road": 83, "Lane": 19, "Way": 11, "Place": 5, "Drive": 3, "Court": 1},
                           "Cities": {"North Fork": 99, " ": 13, "Unincorporated": 8, "Auberry": 2},
                           "CAL FIRE Unit": {"MMU": 112, "FKU": 10},
                           "Structure Type": {"Utility Misc Structure": 42,
                                              "Single Family Residence Single Story": 41,
                                              "Single Family Residence Multi Story": 12, "Motor Home": 10,
                                              "Mobile Home Double Wide": 7, "Commercial Building Single Story": 6,
                                              "Mobile Home Single Wide": 4}, "Radius": 1.6870436658,
                           "Color": "#FF2400"},
    {"Latitude": 38.2183646056, "Longitude": -120.5676953164, "Damage": 2.6205882353,
     "Damage level": {"Destroyed (>50%)": 870, "No Damage": 110, "Affected (1-9%)": 27, "Minor (10-25%)": 7,
                      "Major (26-50%)": 5, "Inaccessible": 1},
     "Street Type": {"Road": 614, "Way": 157, "Lane": 67, "Street": 54, "Trail": 51, "Court": 38, "Drive": 34,
                     "Other": 4, "Place": 1},
     "Cities": {"Mountain Ranch": 515, "Mokelumne Hill": 281, "Copperopolis": 101, "San Andreas": 31,
                "Unincorporated": 26, "Railroad Flat": 24, "Jamestown": 12, "Jamestown ": 10, "Sonora": 9,
                "Sheep Ranch": 4, "Angels Camp": 3, "Glencoe": 2, "Jackson": 1, "Sonora ": 1},
     "CAL FIRE Unit": {"TCU": 1019, "AEU": 1},
     "Structure Type": {"Utility Misc Structure": 384, "Single Family Residence Single Story": 382,
                        "Single Family Residence Multi Story": 130, "Mobile Home Double Wide": 55,
                        "Mobile Home Single Wide": 23, "Commercial Building Single Story": 15,
                        "Mobile Home Triple Wide": 13, "Motor Home": 8, "Multi Family Residence Single Story": 4,
                        "Commercial Building Multi Story": 3, "Multi Family Residence Multi Story": 1,
                        "Infrastructure": 1, "Mixed Commercial\/Residential": 1}, "Radius": 3.5543077412,
     "Color": "#7C0A02"}, {"Latitude": 38.2136224017, "Longitude": -121.0397719768, "Damage": 1.4444444444,
                           "Damage level": {"No Damage": 15, "Destroyed (>50%)": 10, "Inaccessible": 8,
                                            "Affected (1-9%)": 2, "Major (26-50%)": 1},
                           "Street Type": {"Road": 33, "Court": 2, "Street": 1},
                           "Cities": {"Clements": 23, "Valley Springs": 6, "Herald": 4, "Wallace": 2, "Milton": 1},
                           "CAL FIRE Unit": {"AEU": 27, "TCU": 9},
                           "Structure Type": {"Single Family Residence Single Story": 14,
                                              "Utility Misc Structure": 10,
                                              "Single Family Residence Multi Story": 6,
                                              "Mobile Home Triple Wide": 3, "Mobile Home Double Wide": 2,
                                              "Motor Home": 1}, "Radius": 3.5409926189, "Color": "#FF2400"},
    {"Latitude": 32.8295151967, "Longitude": -116.7448269282, "Damage": 2.8,
     "Damage level": {"Destroyed (>50%)": 47, "Affected (1-9%)": 7, "Major (26-50%)": 4, "Minor (10-25%)": 2},
     "Street Type": {"Boulevard": 22, "Road": 19, "Place": 15, "Lane": 4},
     "Cities": {"Alpine ": 31, "Alpine": 28, "Apline": 1}, "CAL FIRE Unit": {"MVU": 60},
     "Structure Type": {"Single Family Residence Single Story": 30, "Mobile Home Double Wide": 12,
                        "Utility Misc Structure": 11, "Single Family Residence Multi Story": 7},
     "Radius": 0.1650456263, "Color": "#7C0A02"},
    {"Latitude": 39.0077384546, "Longitude": -120.7785769925, "Damage": 0.3966942149,
     "Damage level": {"No Damage": 515, "Destroyed (>50%)": 74, "Affected (1-9%)": 14, "Inaccessible": 1,
                      "Minor (10-25%)": 1},
     "Street Type": {"Road": 385, "Street": 140, "Lane": 37, "Way": 20, "Court": 16, "Trail": 3, "Drive": 2,
                     "Route": 1, "Boulevard": 1},
     "Cities": {"Foresthill": 402, "Georgetown": 195, "Unincorporated": 2, "Cool": 2, "Lotus": 2, "Penryn": 1,
                " ": 1}, "CAL FIRE Unit": {"NEU": 405, "AEU": 200},
     "Structure Type": {"Utility Misc Structure": 224, "Single Family Residence Single Story": 163,
                        "Single Family Residence Multi Story": 111, "Commercial Building Single Story": 27,
                        "Motor Home": 20, "Mobile Home Double Wide": 19, "Mobile Home Single Wide": 14,
                        "Commercial Building Multi Story": 12, "Infrastructure": 5, "School": 4,
                        "Mobile Home Triple Wide": 3, "Church": 1, "Multi Family Residence Multi Story": 1,
                        "Mixed Commercial\/Residential": 1}, "Radius": 1.9785858262, "Color": "#FA8072"},
    {"Latitude": 38.4184456415, "Longitude": -120.9108046328, "Damage": 2.3333333333,
     "Damage level": {"Destroyed (>50%)": 2, "Affected (1-9%)": 1}, "Street Type": {"Road": 2, "Court": 1},
     "Cities": {"Ione": 2, "Plymouth": 1}, "CAL FIRE Unit": {"AEU": 3},
     "Structure Type": {"Utility Misc Structure": 2, "Single Family Residence Multi Story": 1},
     "Radius": 0.3471967029, "Color": "#BF0A30"},
    {"Latitude": 37.5024472178, "Longitude": -119.9298954043, "Damage": 0.9143117593,
     "Damage level": {"No Damage": 745, "Destroyed (>50%)": 316, "Affected (1-9%)": 25, "Minor (10-25%)": 5,
                      "Major (26-50%)": 4, "Inaccessible": 2},
     "Street Type": {"Road": 892, "Lane": 67, "Street": 54, "Hwy": 41, "Way": 26, "Other": 9, "Drive": 7,
                     "Court": 1},
     "Cities": {"Mariposa": 873, "Raymond ": 73, "Coulterville": 44, "Midpines": 33, "Catheys Valley": 31,
                "Mariposa ": 27, "Ahwahnee": 7, "La Grange": 4, "Raymond": 2, "Awahanee": 2, " ": 1},
     "CAL FIRE Unit": {"MMU": 1096, "TCU": 1},
     "Structure Type": {"Single Family Residence Single Story": 379, "Utility Misc Structure": 369,
                        "Single Family Residence Multi Story": 133, "Mobile Home Single Wide": 60,
                        "Mobile Home Double Wide": 58, "Commercial Building Single Story": 30, "Motor Home": 28,
                        "Infrastructure": 11, "Multi Family Residence Single Story": 11,
                        "Multi Family Residence Multi Story": 10, "Commercial Building Multi Story": 3,
                        "Hospital": 2, "Church": 1, "School": 1, "Mobile Home Triple Wide": 1},
     "Radius": 3.6599546443, "Color": "#FF2400"},
    {"Latitude": 34.4617488145, "Longitude": -119.8300803741, "Damage": 3.037037037,
     "Damage level": {"Destroyed (>50%)": 24, "Major (26-50%)": 2, "Minor (10-25%)": 1},
     "Street Type": {"Avenue": 17, "Other": 6, "Road": 3, "Alley": 1}, "Cities": {"Goleta ": 21, "Goleta": 6},
     "CAL FIRE Unit": {"SBC": 27},
     "Structure Type": {"Utility Misc Structure": 14, "Single Family Residence Single Story": 8,
                        "Single Family Residence Multi Story": 5}, "Radius": 0.0829651697, "Color": "#7C0A02"},
    {"Latitude": 34.0903027514, "Longitude": -118.4687398803, "Damage": 1.3714285714,
     "Damage level": {"No Damage": 15, "Destroyed (>50%)": 8, "Affected (1-9%)": 6, "Minor (10-25%)": 3,
                      "Major (26-50%)": 3}, "Street Type": {"Drive": 31, "Other": 2, "Lane": 2},
     "Cities": {"Los Angeles": 29, "Los Angeles ": 6}, "CAL FIRE Unit": {"LAC": 35},
     "Structure Type": {"Single Family Residence Multi Story": 21, "Single Family Residence Single Story": 13,
                        "Utility Misc Structure": 1}, "Radius": 0.1094711595, "Color": "#FF2400"},
    {"Latitude": 37.1837986864, "Longitude": -122.0712185056, "Damage": 0.75,
     "Damage level": {"No Damage": 18, "Destroyed (>50%)": 6}, "Street Type": {"Road": 22, "Lane": 2},
     "Cities": {"Boulder Creek": 24}, "CAL FIRE Unit": {"CZU": 24},
     "Structure Type": {"Single Family Residence Single Story": 14, "Utility Misc Structure": 6,
                        "Single Family Residence Multi Story": 3, "Multi Family Residence Single Story": 1},
     "Radius": 0.2170895416, "Color": "#FA8072"},
    {"Latitude": 33.1008983779, "Longitude": -117.1370488899, "Damage": 3.125,
     "Damage level": {"Destroyed (>50%)": 42, "Major (26-50%)": 6},
     "Street Type": {"Drive": 24, "Place": 10, "Road": 8, "Lane": 3, "Circle": 3},
     "Cities": {"ESCONDIDO": 40, "SAN MARCOS": 8}, "CAL FIRE Unit": {"MVU": 48},
     "Structure Type": {"Single Family Residence Single Story": 39, "Utility Misc Structure": 7,
                        "Commercial Building Single Story": 2}, "Radius": 0.2792411019, "Color": "#7C0A02"},
    {"Latitude": 35.7340368606, "Longitude": -121.0127750679, "Damage": 2.8333333333,
     "Damage level": {"Destroyed (>50%)": 58, "Affected (1-9%)": 5, "Minor (10-25%)": 2, "Major (26-50%)": 1},
     "Street Type": {"Road": 27, "Way": 18, "Lane": 14, "Drive": 6, "Unk": 1},
     "Cities": {"Paso Robles": 65, "Bradley": 1}, "CAL FIRE Unit": {"SLU": 65, "BEU": 1},
     "Structure Type": {"Single Family Residence Single Story": 30, "Utility Misc Structure": 19,
                        "Single Family Residence Multi Story": 11, "Motor Home": 2, "Mobile Home Single Wide": 2,
                        "Mobile Home Double Wide": 1, "Mobile Home Triple Wide": 1}, "Radius": 0.9428456587,
     "Color": "#7C0A02"}, {"Latitude": 41.4790611745, "Longitude": -122.3670876438, "Damage": 2.1368078176,
                           "Damage level": {"Destroyed (>50%)": 352, "No Damage": 130, "Inaccessible": 104,
                                            "Affected (1-9%)": 14, "Minor (10-25%)": 11, "Major (26-50%)": 3},
                           "Street Type": {"Avenue": 166, "Drive": 130, "Street": 122, "Road": 115, "Court": 49,
                                           "Way": 12, "Lane": 11, "Other": 5, "Place": 4},
                           "Cities": {"Weed": 478, "Montague ": 65, "Montague": 63, " ": 6, "Montagie": 1,
                                      "Montafue": 1}, "CAL FIRE Unit": {"SKU": 614},
                           "Structure Type": {"Single Family Residence Single Story": 301,
                                              "Utility Misc Structure": 231,
                                              "Single Family Residence Multi Story": 52, "Motor Home": 8,
                                              "Commercial Building Single Story": 7, "Mobile Home Double Wide": 6,
                                              "Mobile Home Single Wide": 3, "Church": 2,
                                              "Utility or Miscellaneous Structure > 120 sqft": 1,
                                              "Commercial Building Multi Story": 1,
                                              "Multi Family Residence Single Story": 1,
                                              "Mobile Home Triple Wide": 1}, "Radius": 1.8500522184,
                           "Color": "#BF0A30"},
    {"Latitude": 37.5076380795, "Longitude": -118.6367411449, "Damage": 2.8909090909,
     "Damage level": {"Destroyed (>50%)": 49, "Minor (10-25%)": 6},
     "Street Type": {"Road": 43, "Drive": 9, "Grade": 2, "Trail": 1}, "Cities": {"Bishop": 55},
     "CAL FIRE Unit": {"BDU": 55},
     "Structure Type": {"Single Family Residence Single Story": 25, "Utility Misc Structure": 17,
                        "Single Family Residence Multi Story": 12, "Mobile Home Single Wide": 1},
     "Radius": 0.491090599, "Color": "#7C0A02"},
    {"Latitude": 34.9509393163, "Longitude": -120.2326323705, "Damage": 2.8571428571,
     "Damage level": {"Destroyed (>50%)": 13, "Affected (1-9%)": 1}, "Street Type": {"Road": 12, "Drive": 2},
     "Cities": {"Santa Maria": 14}, "CAL FIRE Unit": {"SBC": 14},
     "Structure Type": {"Utility Misc Structure": 9, "Single Family Residence Single Story": 3,
                        "Utility or Miscellaneous Structure > 120 sqft": 2}, "Radius": 0.5656233072,
     "Color": "#7C0A02"},
    {"Latitude": 37.750120036, "Longitude": -118.9225583114, "Damage": 3.0, "Damage level": {"Destroyed (>50%)": 7},
     "Street Type": {"Road": 7}, "Cities": {"Unincorporated": 7}, "CAL FIRE Unit": {"BDU": 7},
     "Structure Type": {"Single Family Residence Single Story": 5, "Utility Misc Structure": 1,
                        "Utility or Miscellaneous Structure > 120 sqft": 1}, "Radius": 0.0690626149,
     "Color": "#7C0A02"}, {"Latitude": 37.1123141539, "Longitude": -121.8209933049, "Damage": 3.0344827586,
                           "Damage level": {"Destroyed (>50%)": 28, "Major (26-50%)": 1},
                           "Street Type": {"Road": 29}, "Cities": {"Los Gatos": 17, "Unincorporated": 12},
                           "CAL FIRE Unit": {"SCU": 29}, "Structure Type": {"Utility Misc Structure": 16,
                                                                            "Single Family Residence Single Story": 6,
                                                                            "Single Family Residence Multi Story": 3,
                                                                            "Mobile Home Single Wide": 3,
                                                                            "Motor Home": 1},
                           "Radius": 0.4006645957, "Color": "#7C0A02"},
    {"Latitude": 33.297197526, "Longitude": -117.1977684444, "Damage": 2.5887850467,
     "Damage level": {"Destroyed (>50%)": 72, "Minor (10-25%)": 20, "Affected (1-9%)": 13, "Major (26-50%)": 2},
     "Street Type": {"Road": 61, "Street": 19, "Drive": 17, "Other": 6, "Way": 2, "Court": 2},
     "Cities": {"Unincorporated": 105, "Oceanside": 2}, "CAL FIRE Unit": {"MVU": 107},
     "Structure Type": {"Single Family Residence Single Story": 36, "Utility Misc Structure": 33,
                        "Mobile Home Double Wide": 15, "Single Family Residence Multi Story": 12,
                        "Mobile Home Triple Wide": 5, "Motor Home": 3, "Mobile Home Single Wide": 1, "School": 1,
                        "Commercial Building Single Story": 1}, "Radius": 0.7819256376, "Color": "#7C0A02"},
    {"Latitude": 33.8278309889, "Longitude": -117.7382583486, "Damage": 2.3428571429,
     "Damage level": {"Destroyed (>50%)": 24, "Minor (10-25%)": 22, "Affected (1-9%)": 16, "Major (26-50%)": 8},
     "Street Type": {"Drive": 39, "Road": 21, "Circle": 5, "Court": 3, "Lane": 1, "Way": 1},
     "Cities": {"Orange": 30, "Anaheim": 17, "Anaheim ": 12, "Corona": 6, "Santa Ana": 3, "Orange ": 1,
                "Anaheim Hills": 1}, "CAL FIRE Unit": {"ORC": 64, "RRU": 6},
     "Structure Type": {"Single Family Residence Multi Story": 47, "Utility Misc Structure": 17,
                        "Single Family Residence Single Story": 4, "Commercial Building Single Story": 2},
     "Radius": 1.3923332952, "Color": "#BF0A30"},
    {"Latitude": 39.0773585997, "Longitude": -121.3418574723, "Damage": 2.875,
     "Damage level": {"Destroyed (>50%)": 7, "Minor (10-25%)": 1}, "Street Type": {"Road": 6, "Lane": 2},
     "Cities": {"Wheatland": 8}, "CAL FIRE Unit": {"NEU": 8},
     "Structure Type": {"Utility Misc Structure": 5, "Mobile Home Double Wide": 2,
                        "Single Family Residence Multi Story": 1}, "Radius": 0.3544506332, "Color": "#7C0A02"},
    {"Latitude": 40.7140278395, "Longitude": -123.1135723785, "Damage": 0.9024390244,
     "Damage level": {"No Damage": 198, "Destroyed (>50%)": 82, "Minor (10-25%)": 3, "Affected (1-9%)": 3,
                      "Major (26-50%)": 1},
     "Street Type": {"Road": 191, "Other": 33, "Way": 20, "Lane": 15, "Hwy": 13, "Court": 6, "Drive": 4,
                     "Avenue": 3, "Street": 2}, "Cities": {"Junction City": 192, "Hayfork": 54, "Big Bar": 41},
     "CAL FIRE Unit": {"SHU": 287},
     "Structure Type": {"Utility Misc Structure": 117, "Single Family Residence Single Story": 74,
                        "Single Family Residence Multi Story": 32, "Mobile Home Single Wide": 17, "Motor Home": 17,
                        "Mobile Home Double Wide": 16, "Commercial Building Single Story": 4,
                        "Mixed Commercial\/Residential": 4, "School": 3, "Mobile Home Triple Wide": 2,
                        "Infrastructure": 1}, "Radius": 3.1516495744, "Color": "#FF2400"},
    {"Latitude": 37.4540172563, "Longitude": -119.6463910609, "Damage": 2.7777777778,
     "Damage level": {"Destroyed (>50%)": 8, "Affected (1-9%)": 1}, "Street Type": {"Hwy": 5, "Road": 4},
     "Cities": {"Oakhurst": 5, "Fish Camp": 2, "Alta Dena": 2}, "CAL FIRE Unit": {"MMU": 9},
     "Structure Type": {"Single Family Residence Multi Story": 4, "Single Family Residence Single Story": 3,
                        "Utility Misc Structure": 2}, "Radius": 0.1429462068, "Color": "#7C0A02"},
    {"Latitude": 33.9728079789, "Longitude": -117.4319267215, "Damage": 0.6,
     "Damage level": {"No Damage": 45, "Destroyed (>50%)": 7, "Affected (1-9%)": 3, "Minor (10-25%)": 2,
                      "Inaccessible": 2, "Major (26-50%)": 1},
     "Street Type": {"Street": 19, "Road": 17, "Drive": 13, "Avenue": 7, "Way": 4},
     "Cities": {"Riverside ": 26, "Jurupa Valley": 18, "Riverside": 11, "Riversise": 4, "Riversida": 1},
     "CAL FIRE Unit": {"RRU": 60},
     "Structure Type": {"Commercial Building Single Story": 22, "Single Family Residence Single Story": 22,
                        "Utility Misc Structure": 8, "Single Family Residence Multi Story": 8},
     "Radius": 0.3451392933, "Color": "#FA8072"},
    {"Latitude": 34.5138811313, "Longitude": -118.6392249243, "Damage": 2.4285714286,
     "Damage level": {"Minor (10-25%)": 3, "Destroyed (>50%)": 2, "Affected (1-9%)": 1, "Major (26-50%)": 1},
     "Street Type": {"Road": 7}, "Cities": {"Unincorporated": 7}, "CAL FIRE Unit": {"LAC": 7},
     "Structure Type": {"Single Family Residence Multi Story": 7}, "Radius": 0.045397942, "Color": "#7C0A02"},
    {"Latitude": 32.9971066772, "Longitude": -116.4711351816, "Damage": 3.0,
     "Damage level": {"Destroyed (>50%)": 3}, "Street Type": {"Road": 2, "Route": 1},
     "Cities": {"Julian": 2, "Julian ": 1}, "CAL FIRE Unit": {"MVU": 3},
     "Structure Type": {"Single Family Residence Single Story": 2, "Mobile Home Double Wide": 1},
     "Radius": 0.5247377363, "Color": "#7C0A02"},
    {"Latitude": 40.2960784985, "Longitude": -121.8255441672, "Damage": 1.6632653061,
     "Damage level": {"Destroyed (>50%)": 105, "No Damage": 86, "Inaccessible": 2, "Major (26-50%)": 1,
                      "Minor (10-25%)": 1, "Affected (1-9%)": 1},
     "Street Type": {"Road": 115, "Way": 57, "Loop": 10, "Other": 6, "Avenue": 5, "Trail": 3},
     "Cities": {"Paynes Creek": 135, "Mineral": 37, "Red Bluff": 14, "Manton ": 4, "Los Molinos": 3, "Manton": 2,
                "Corning": 1}, "CAL FIRE Unit": {"TGU": 196},
     "Structure Type": {"Single Family Residence Single Story": 94, "Utility Misc Structure": 72,
                        "Single Family Residence Multi Story": 10, "Mobile Home Single Wide": 9,
                        "Mobile Home Double Wide": 4, "Motor Home": 3, "Infrastructure": 3,
                        "Mobile Home Triple Wide": 1}, "Radius": 2.8274195223, "Color": "#BF0A30"},
    {"Latitude": 36.7296529364, "Longitude": -119.273295165, "Damage": 0.5434782609,
     "Damage level": {"No Damage": 38, "Destroyed (>50%)": 7, "Major (26-50%)": 1},
     "Street Type": {"Road": 39, "Lane": 6, "Drive": 1},
     "Cities": {"Reedley": 23, "Squaw Valley": 18, "Sanger": 2, " ": 2, "Parlier": 1}, "CAL FIRE Unit": {"FKU": 46},
     "Structure Type": {"Infrastructure": 17, "Utility Misc Structure": 13, "Mobile Home Single Wide": 5,
                        "Single Family Residence Single Story": 5, "Mobile Home Double Wide": 3, "Motor Home": 2,
                        "Single Family Residence Multi Story": 1}, "Radius": 1.8932558289, "Color": "#FA8072"},
    {"Latitude": 33.5858094836, "Longitude": -116.4444075237, "Damage": 2.3333333333,
     "Damage level": {"Destroyed (>50%)": 2, "Affected (1-9%)": 1}, "Street Type": {"Other": 3},
     "Cities": {"Pinyon": 3}, "CAL FIRE Unit": {"RRU": 3},
     "Structure Type": {"Single Family Residence Single Story": 1, "Utility Misc Structure": 1,
                        "Single Family Residence Multi Story": 1}, "Radius": 0.0092988649, "Color": "#BF0A30"},
    {"Latitude": 38.7032284264, "Longitude": -119.8031314194, "Damage": 0.1416430595,
     "Damage level": {"No Damage": 335, "Destroyed (>50%)": 15, "Minor (10-25%)": 1, "Affected (1-9%)": 1,
                      "Inaccessible": 1},
     "Street Type": {"Road": 207, "Street": 66, "Lane": 53, "Other": 16, "Court": 9, "Route": 2},
     "Cities": {"Markleeville ": 222, "Markleeville": 118, "Markleville ": 13}, "CAL FIRE Unit": {"AEU": 353},
     "Structure Type": {"Single Family Residence Multi Story": 114, "Utility Misc Structure": 111,
                        "Single Family Residence Single Story": 87, "Infrastructure": 13,
                        "Multi Family Residence Multi Story": 11, "Commercial Building Single Story": 10,
                        "Mobile Home Double Wide": 3, "Motor Home": 3, "Mixed Commercial\/Residential": 1},
     "Radius": 1.0000975289, "Color": "#FA8072"},
    {"Latitude": 41.583131705, "Longitude": -121.9122804634, "Damage": 0.4885496183,
     "Damage level": {"No Damage": 107, "Destroyed (>50%)": 20, "Affected (1-9%)": 4},
     "Street Type": {"Road": 77, "Lane": 54}, "Cities": {"Macdoel": 77, "Macdoel ": 53, "Macdoal": 1},
     "CAL FIRE Unit": {"SKU": 131},
     "Structure Type": {"Single Family Residence Single Story": 104, "Utility Misc Structure": 10,
                        "Single Family Residence Multi Story": 9, "Commercial Building Single Story": 3,
                        "Mobile Home Double Wide": 2, "Commercial Building Multi Story": 2,
                        "Mobile Home Single Wide": 1}, "Radius": 0.5888331111, "Color": "#FA8072"},
    {"Latitude": 34.4958669719, "Longitude": -120.0668563801, "Damage": 0.3027522936,
     "Damage level": {"No Damage": 97, "Destroyed (>50%)": 10, "Inaccessible": 1, "Affected (1-9%)": 1},
     "Street Type": {"Road": 108, "Lane": 1}, "Cities": {"Goleta ": 63, "Goleta": 34, "Gaviota": 12},
     "CAL FIRE Unit": {"SBC": 109},
     "Structure Type": {"Single Family Residence Single Story": 49, "Utility Misc Structure": 27,
                        "Single Family Residence Multi Story": 15, "Commercial Building Single Story": 9,
                        "Mobile Home Double Wide": 5, "Mixed Commercial\/Residential": 3,
                        "Mobile Home Triple Wide": 1}, "Radius": 0.7158933578, "Color": "#FA8072"},
    {"Latitude": 32.6127657489, "Longitude": -116.6734515964, "Damage": 0.7822580645,
     "Damage level": {"No Damage": 90, "Destroyed (>50%)": 28, "Affected (1-9%)": 3, "Major (26-50%)": 2,
                      "Minor (10-25%)": 1}, "Street Type": {"Road": 91, "Other": 28, "Lane": 5},
     "Cities": {"Dulzura": 60, "Jamul": 32, "Potrero": 23, "Tecate": 9}, "CAL FIRE Unit": {"MVU": 119, "SDU": 5},
     "Structure Type": {"Utility Misc Structure": 32, "Mobile Home Single Wide": 30,
                        "Single Family Residence Single Story": 23, "Motor Home": 19, "Mobile Home Double Wide": 12,
                        "Single Family Residence Multi Story": 3, "Mobile Home Triple Wide": 2,
                        "Commercial Building Single Story": 2, "Infrastructure": 1}, "Radius": 0.8149193982,
     "Color": "#FA8072"}, {"Latitude": 33.5220304506, "Longitude": -117.7262124339, "Damage": 0.2777777778,
                           "Damage level": {"No Damage": 32, "Destroyed (>50%)": 3, "Affected (1-9%)": 1},
                           "Street Type": {"Other": 33, "Court": 2, "Drive": 1}, "Cities": {"Laguna Niguel": 36},
                           "CAL FIRE Unit": {"ORC": 36},
                           "Structure Type": {"Single Family Residence Multi Story": 35,
                                              "Utility Misc Structure": 1}, "Radius": 0.0555668608,
                           "Color": "#FA8072"},
    {"Latitude": 40.0067582294, "Longitude": -122.4481951367, "Damage": 0.6734693878,
     "Damage level": {"No Damage": 35, "Destroyed (>50%)": 9, "Affected (1-9%)": 4, "Minor (10-25%)": 1},
     "Street Type": {"Road": 25, "Court": 12, "Drive": 5, "Other": 4, "Trail": 3},
     "Cities": {"Corning": 44, "Red Bluff": 4, " ": 1}, "CAL FIRE Unit": {"TGU": 49},
     "Structure Type": {"Mobile Home Double Wide": 15, "Mobile Home Single Wide": 10,
                        "Single Family Residence Single Story": 8, "Utility Misc Structure": 7,
                        "Mobile Home Triple Wide": 4, "Motor Home": 3, "Single Family Residence Multi Story": 2},
     "Radius": 0.2835762833, "Color": "#FA8072"},
    {"Latitude": 36.8929438076, "Longitude": -121.6081968135, "Damage": 0.4054054054,
     "Damage level": {"No Damage": 32, "Destroyed (>50%)": 5}, "Street Type": {"Road": 37},
     "Cities": {"San Juan Bautista": 23, "Aromas": 14}, "CAL FIRE Unit": {"BEU": 37},
     "Structure Type": {"Single Family Residence Single Story": 17, "Utility Misc Structure": 14,
                        "Mobile Home Double Wide": 3, "Multi Family Residence Multi Story": 1,
                        "Single Family Residence Multi Story": 1, "Infrastructure": 1}, "Radius": 0.6012116576,
     "Color": "#FA8072"}, {"Latitude": 41.4572094878, "Longitude": -122.6431074889, "Damage": 1.3333333333,
                           "Damage level": {"No Damage": 5, "Destroyed (>50%)": 4}, "Street Type": {"Road": 9},
                           "Cities": {"Gazelle": 9}, "CAL FIRE Unit": {"SKU": 9},
                           "Structure Type": {"Utility Misc Structure": 5,
                                              "Single Family Residence Single Story": 3,
                                              "Single Family Residence Multi Story": 1}, "Radius": 0.7304435044,
                           "Color": "#FF2400"},
    {"Latitude": 37.7866654824, "Longitude": -120.7547658043, "Damage": 0.5238095238,
     "Damage level": {"No Damage": 15, "Affected (1-9%)": 3, "Destroyed (>50%)": 2, "Minor (10-25%)": 1},
     "Street Type": {"Road": 21}, "Cities": {"Oakdale": 21}, "CAL FIRE Unit": {"TCU": 21},
     "Structure Type": {"Commercial Building Single Story": 10, "Single Family Residence Single Story": 6,
                        "Single Family Residence Multi Story": 2, "Mobile Home Double Wide": 1,
                        "Commercial Building Multi Story": 1, "Utility Misc Structure": 1}, "Radius": 0.057296964,
     "Color": "#FA8072"},
    {"Latitude": 39.2811196417, "Longitude": -122.4571585167, "Damage": 0.0, "Damage level": {"No Damage": 24},
     "Street Type": {"Road": 24}, "Cities": {"Stonyford": 17, "Williams": 7}, "CAL FIRE Unit": {"LNU": 24},
     "Structure Type": {"Utility Misc Structure": 15, "Single Family Residence Single Story": 5,
                        "Single Family Residence Multi Story": 2, "Mobile Home Single Wide": 1, "Motor Home": 1},
     "Radius": 1.9260465675, "Color": "#FA8072"},
    {"Latitude": 34.7405452088, "Longitude": -118.8148240676, "Damage": 0.2941176471,
     "Damage level": {"No Damage": 30, "Inaccessible": 2, "Major (26-50%)": 1, "Minor (10-25%)": 1},
     "Street Type": {"Other": 13, "Road": 9, "Lane": 9, "Way": 3},
     "Cities": {"Lancaster": 28, "Gorman": 5, "Lebec": 1}, "CAL FIRE Unit": {"LAC": 34},
     "Structure Type": {"Utility Misc Structure": 18, "Single Family Residence Single Story": 11,
                        "Commercial Building Single Story": 4, "Infrastructure": 1}, "Radius": 1.0367134769,
     "Color": "#FA8072"},
    {"Latitude": 36.2151001136, "Longitude": -120.5760938627, "Damage": 0.0, "Damage level": {"No Damage": 59},
     "Street Type": {"Road": 54, "Other": 5}, "Cities": {"Coalinga": 59}, "CAL FIRE Unit": {"FKU": 59},
     "Structure Type": {"Utility Misc Structure": 23, "Single Family Residence Single Story": 16,
                        "Mobile Home Double Wide": 8, "Mobile Home Single Wide": 7, "Motor Home": 3,
                        "Mixed Commercial\/Residential": 1, "Single Family Residence Multi Story": 1},
     "Radius": 1.2769448196, "Color": "#FA8072"},
    {"Latitude": 34.3277913989, "Longitude": -117.6526149658, "Damage": 0.2887931034,
     "Damage level": {"No Damage": 618, "Destroyed (>50%)": 47, "Inaccessible": 23, "Affected (1-9%)": 6,
                      "Major (26-50%)": 2},
     "Street Type": {"Drive": 265, "Road": 257, "Avenue": 86, "Hwy": 61, "Street": 15, "Court": 4, "Lane": 4,
                     "Other": 4},
     "Cities": {"Wrightwood": 357, "Mt Baldy": 172, "Llano": 113, "Valyermo": 23, "Pinon Hills": 9,
                "North Hollywood": 8, "Monrovia": 8, "Mt. Baldy": 3, "MT. BALDY": 2, "Claremont": 1},
     "CAL FIRE Unit": {"BDU": 436, "LAC": 260},
     "Structure Type": {"Single Family Residence Multi Story": 275, "Utility Misc Structure": 226,
                        "Single Family Residence Single Story": 150, "Commercial Building Single Story": 26,
                        "Commercial Building Multi Story": 5, "Infrastructure": 4, "Church": 3,
                        "Mixed Commercial\/Residential": 2, "Motor Home": 2, "Mobile Home Double Wide": 1,
                        "Multi Family Residence Multi Story": 1, "School": 1}, "Radius": 1.7350567067,
     "Color": "#FA8072"}, {"Latitude": 36.5052638929, "Longitude": -118.1013736357, "Damage": 2.0,
                           "Damage level": {"Destroyed (>50%)": 8, "No Damage": 3, "Affected (1-9%)": 2,
                                            "Minor (10-25%)": 1}, "Street Type": {"Road": 14},
                           "Cities": {"Lone Pine": 14}, "CAL FIRE Unit": {"BDU": 14},
                           "Structure Type": {"Utility Misc Structure": 11,
                                              "Single Family Residence Single Story": 2, "Motor Home": 1},
                           "Radius": 0.0375402386, "Color": "#BF0A30"}]


def latlon_to_meters(lat1, lon1, lat2, lon2):
    """Convert latitude/longitude difference to meters"""
    R = 6371000  # Earth radius in meters

    # Convert degrees to radians
    lat1, lon1, lat2, lon2 = map(math.radians, [lat1, lon1, lat2, lon2])

    # Calculate differences
    dlat = lat2 - lat1
    dlon = lon2 - lon1

    # Haversine formula
    a = math.sin(dlat / 2) ** 2 + math.cos(lat1) * math.cos(lat2) * math.sin(dlon / 2) ** 2
    c = 2 * math.atan2(math.sqrt(a), math.sqrt(1 - a))

    distance = R * c  # Distance in meters
    return distance


def get_clusters_around_point(lat, lon, radius):
    clusters_in_region = []
    for cluster in data:
        dis_to_center = latlon_to_meters(lat, lon, cluster['Latitude'], cluster['Longitude'])
        if dis_to_center < (radius - cluster["Radius"] * 1.61 * 1000) * 0.98:
            num_of_fire = sum(cluster['Damage level'].values())

            average_damage = list(cluster['Damage level'].keys())[0]
            if average_damage == 'Inaccessible' and len(cluster['Damage level']) > 1:
                average_damage = list(cluster['Damage level'].keys())[1]

            clusters_in_region.append({'lat': cluster['Latitude'], 'lng': cluster['Longitude'],
                                       'radius': cluster['Radius'], 'color': cluster['Color'],
                                       'numOfFire': num_of_fire, 'damageLevel': average_damage})
    return clusters_in_region


def get_cluster_info_closet_to_point(lat, lon):
    # Find the cluster with the closest lat and lon
    min_dist = 1e9
    cluster_data = {}
    for cluster in data:
        dist = (cluster["Latitude"] - lat) ** 2 + (cluster["Longitude"] - lon) ** 2
        if dist < min_dist:
            min_dist = dist
            cluster_data = cluster

    temp = {}
    for label in ['No Damage', 'Affected (1-9%)', 'Minor (10-25%)', 'Major (26-50%)', 'Destroyed (>50%)',
                  'Inaccessible']:
        if label in cluster_data['Damage level']:
            temp[label] = cluster_data['Damage level'][label]
        else:
            temp[label] = 0

    cluster_data['Damage level'] = temp
    cluster_data["Street Type"] = dict(islice(cluster_data["Street Type"].items(), 6))
    cluster_data["Cities"] = dict(islice(cluster_data["Cities"].items(), 6))
    cluster_data["CAL FIRE Unit"] = dict(islice(cluster_data["CAL FIRE Unit"].items(), 1))
    cluster_data["Structure Type"] = dict(islice(cluster_data["Structure Type"].items(), 6))

    return cluster_data


@csrf_exempt
def get_clusters(request):
    if request.method == 'POST' or request.method == 'OPTIONS':
        data = json.loads(request.body)
        lat = float(data['lat'])
        lon = float(data['lng'])
        radius = float(data['radius'])
        clusters = get_clusters_around_point(lat, lon, radius)
        return JsonResponse({"clusters": clusters})


@csrf_exempt
def get_cluster_data(request):
    if request.method == 'POST' or request.method == 'OPTIONS':
        data = json.loads(request.body)
        lat = data['lat']
        lon = data['lng']

        cluster_data = get_cluster_info_closet_to_point(lat, lon)

        return JsonResponse(cluster_data)
